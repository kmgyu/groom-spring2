<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}">
<head>
    <title th:text="|상품 상세보기 - ${product.name}|">상품 상세보기</title>
</head>
<body>
    <div layout:fragment="content" class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- 헤더 -->
        <div class="mb-8 flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-bold text-gray-900">상품 상세보기</h1>
                <p class="mt-2 text-sm text-gray-600">상품의 상세 정보를 확인합니다.</p>
            </div>
            <div class="flex space-x-3">
                <a th:href="@{/products/{id}/edit(id=${product.productSeq})}"
                   class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    수정
                </a>
                <form th:action="@{/products/{id}/delete(id=${product.productSeq})}" method="post" class="inline"
                      onsubmit="return confirm('정말 삭제하시겠습니까?')">
                    <button type="submit"
                            class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500">
                        삭제
                    </button>
                </form>
                <a th:href="@{/products}"
                   class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    목록
                </a>
            </div>
        </div>

        <!-- 성공/오류 메시지 -->
        <div th:if="${successMessage}" class="mb-6 p-4 bg-green-50 border border-green-200 rounded-md">
            <div class="text-green-800" th:text="${successMessage}">성공 메시지</div>
        </div>
        <div th:if="${errorMessage}" class="mb-6 p-4 bg-red-50 border border-red-200 rounded-md">
            <div class="text-red-800" th:text="${errorMessage}">오류 메시지</div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- 상품 이미지 -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">상품 이미지</h3>
                    <div class="aspect-square bg-gray-100 rounded-lg flex items-center justify-center overflow-hidden">
                        <img th:if="${product.hasImage()}"
                             th:src="${product.imageUrl}"
                             th:alt="${product.name}"
                             class="w-full h-full object-cover">
                        <div th:unless="${product.hasImage()}" class="text-center">
                            <svg class="mx-auto h-12 w-12 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                            </svg>
                            <p class="mt-2 text-sm text-gray-500">이미지 없음</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 상품 정보 -->
            <div class="lg:col-span-2">
                <!-- 기본 정보 -->
                <div class="bg-white rounded-lg shadow p-6 mb-8">
                    <h3 class="text-lg font-medium text-gray-900 mb-6">기본 정보</h3>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- 상품명 -->
                        <div class="md:col-span-2">
                            <dt class="text-sm font-medium text-gray-500">상품명</dt>
                            <dd class="mt-1 text-lg font-semibold text-gray-900" th:text="${product.name}">MacBook Pro 16인치</dd>
                        </div>

                        <!-- 상품 코드 -->
                        <div>
                            <dt class="text-sm font-medium text-gray-500">상품 코드</dt>
                            <dd class="mt-1 text-sm text-gray-900 font-mono" th:text="${product.code}">MBP-16-2024</dd>
                        </div>

                        <!-- 상태 -->
                        <div>
                            <dt class="text-sm font-medium text-gray-500">상태</dt>
                            <dd class="mt-1">
                                <span th:class="|inline-flex px-2 py-1 text-xs font-semibold rounded-full ${product.status.name() == 'ACTIVE' ? 'bg-green-100 text-green-800' : (product.status.name() == 'INACTIVE' ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800')}|"
                                      th:text="${product.status.displayName}">
                                    판매중
                                </span>
                            </dd>
                        </div>

                        <!-- 카테고리 -->
                        <div>
                            <dt class="text-sm font-medium text-gray-500">카테고리</dt>
                            <dd class="mt-1 text-sm text-gray-900" th:text="${product.categoryName ?: '미분류'}">전자제품</dd>
                        </div>

                        <!-- 공급업체 -->
                        <div>
                            <dt class="text-sm font-medium text-gray-500">공급업체</dt>
                            <dd class="mt-1 text-sm text-gray-900" th:text="${product.supplierName ?: '미지정'}">공급업체 A</dd>
                        </div>

                        <!-- SKU -->
                        <div th:if="${product.sku}">
                            <dt class="text-sm font-medium text-gray-500">SKU</dt>
                            <dd class="mt-1 text-sm text-gray-900 font-mono" th:text="${product.sku}">SKU-001</dd>
                        </div>

                        <!-- 바코드 -->
                        <div th:if="${product.barcode}">
                            <dt class="text-sm font-medium text-gray-500">바코드</dt>
                            <dd class="mt-1 text-sm text-gray-900 font-mono" th:text="${product.barcode}">8801234567890</dd>
                        </div>

                        <!-- 상품 설명 -->
                        <div class="md:col-span-2" th:if="${product.description}">
                            <dt class="text-sm font-medium text-gray-500">상품 설명</dt>
                            <dd class="mt-1 text-sm text-gray-700 whitespace-pre-wrap" th:text="${product.description}">상품에 대한 상세한 설명입니다.</dd>
                        </div>
                    </div>
                </div>

                <!-- 가격 정보 -->
                <div class="bg-white rounded-lg shadow p-6 mb-8">
                    <h3 class="text-lg font-medium text-gray-900 mb-6">가격 정보</h3>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- 판매가 -->
                        <div>
                            <dt class="text-sm font-medium text-gray-500">판매가</dt>
                            <dd class="mt-1 text-2xl font-bold text-blue-600">
                                ₩<span th:text="${#numbers.formatDecimal(product.unitPrice, 0, 'COMMA', 0, 'POINT')}">3,500,000</span>
                            </dd>
                        </div>

                        <!-- 원가 -->
                        <div>
                            <dt class="text-sm font-medium text-gray-500">원가</dt>
                            <dd class="mt-1 text-xl font-semibold text-gray-700">
                                ₩<span th:text="${#numbers.formatDecimal(product.unitCost, 0, 'COMMA', 0, 'POINT')}">3,200,000</span>
                            </dd>
                        </div>

                        <!-- 마진액 -->
                        <div>
                            <dt class="text-sm font-medium text-gray-500">마진액</dt>
                            <dd class="mt-1 text-lg font-semibold text-green-600">
                                ₩<span th:text="${#numbers.formatDecimal(product.marginAmount, 0, 'COMMA', 0, 'POINT')}">300,000</span>
                            </dd>
                        </div>

                        <!-- 마진율 -->
                        <div>
                            <dt class="text-sm font-medium text-gray-500">마진율</dt>
                            <dd class="mt-1 text-lg font-semibold text-green-600">
                                <span th:text="${#numbers.formatDecimal(product.marginRate, 1, 'POINT', 1, 'POINT')}">9.4</span>%
                            </dd>
                        </div>

                        <!-- 단위 -->
                        <div>
                            <dt class="text-sm font-medium text-gray-500">판매 단위</dt>
                            <dd class="mt-1 text-sm text-gray-900" th:text="${product.unit.displayName}">개</dd>
                        </div>
                    </div>
                </div>

                <!-- 추가 정보 -->
                <div class="bg-white rounded-lg shadow p-6 mb-8">
                    <h3 class="text-lg font-medium text-gray-900 mb-6">추가 정보</h3>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- 무게 -->
                        <div th:if="${product.weight != null and product.weight > 0}">
                            <dt class="text-sm font-medium text-gray-500">무게</dt>
                            <dd class="mt-1 text-sm text-gray-900">
                                <span th:text="${#numbers.formatDecimal(product.weight, 1, 'POINT', 3, 'POINT')}">2.000</span> kg
                            </dd>
                        </div>

                        <!-- 크기 -->
                        <div th:if="${product.dimensions}">
                            <dt class="text-sm font-medium text-gray-500">크기</dt>
                            <dd class="mt-1 text-sm text-gray-900" th:text="${product.dimensions}">35.79 x 24.59 x 1.68 cm</dd>
                        </div>

                        <!-- 등록일 -->
                        <div>
                            <dt class="text-sm font-medium text-gray-500">등록일</dt>
                            <dd class="mt-1 text-sm text-gray-900" th:text="${#temporals.format(product.createdAt, 'yyyy년 MM월 dd일 HH:mm')}">2024년 12월 15일 14:30</dd>
                        </div>

                        <!-- 수정일 -->
                        <div th:if="${product.updatedAt != null and product.updatedAt != product.createdAt}">
                            <dt class="text-sm font-medium text-gray-500">수정일</dt>
                            <dd class="mt-1 text-sm text-gray-900" th:text="${#temporals.format(product.updatedAt, 'yyyy년 MM월 dd일 HH:mm')}">2024년 12월 15일 15:45</dd>
                        </div>
                    </div>
                </div>

                <!-- 판매 상태 -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-medium text-gray-900 mb-6">판매 상태</h3>

                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div class="flex items-center">
                            <div th:class="|w-3 h-3 rounded-full mr-3 ${product.sellable ? 'bg-green-500' : 'bg-red-500'}|"></div>
                            <span class="text-sm font-medium text-gray-900" th:text="${product.sellable ? '판매 가능' : '판매 불가'}">판매 가능</span>
                        </div>
                        <div class="text-sm text-gray-500">
                            <span th:if="${product.active}">활성 상태</span>
                            <span th:unless="${product.active}">비활성 상태</span>
                        </div>
                    </div>

                    <div class="mt-4 text-sm text-gray-600" th:if="${!product.priceValid}">
                        <div class="p-3 bg-yellow-50 border border-yellow-200 rounded-md">
                            <div class="flex">
                                <svg class="w-4 h-4 text-yellow-400 mr-2 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                                </svg>
                                <p>판매가가 원가보다 낮습니다. 가격을 확인해주세요.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 탭 영역 (향후 재고 이력용) -->
        <div class="mt-8 bg-white rounded-lg shadow">
            <div class="border-b border-gray-200">
                <nav class="-mb-px flex">
                    <button class="py-4 px-6 border-b-2 border-blue-500 text-blue-600 font-medium text-sm">
                        재고 이력
                    </button>
                </nav>
            </div>
            <div class="p-6">
                <div class="text-center py-8 text-gray-500">
                    <svg class="mx-auto h-12 w-12 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                    </svg>
                    <p class="mt-2">재고 이력이 없습니다.</p>
                    <p class="text-sm text-gray-400">Phase 2에서 구현 예정입니다.</p>
                </div>
            </div>
        </div>
    </div>
</body>
</html>